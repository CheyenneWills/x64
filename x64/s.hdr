
	bits	64
        section	.text

;
;  no header code in 386 version.
;
	%define	XL	RSI
	%define	XR	RDI
	%define	WA	RCX
	%define WA_L	CL
	%define	WB	RBX
	%define WB_L    BL
	%define	WC	RDX
	%define WC_L    DL
	%define	XS	RSP
	%define	W0	RAX
	%define	W0_L	AL
	%define	IA	RDX
	%define	XT	RSP

	%define	Qword dword
	extern	_rc_
	extern	zz
	extern	osisp
	extern	compsp

	%macro	ZZZ	1
	mov	qword [zz_zz],%1
	mov	qword [zz_xl],XL
	mov	qword [zz_xr],XR
	mov	qword [zz_xs],XS
	mov	qword [zz_wa],WA
	mov	qword [zz_wb],WB
	mov	qword [zz_wc],WC
	mov	qword [zz_w0],W0
; switch to C's stack
	mov	qword [compsp],rsp
	mov	rsp,qword [osisp]
 	call	zz
;	save C's stack pointer
	mov	qword [osisp],rsp
;	restore compiler stack pointer
	mov	rsp,qword [compsp]
	%endmacro
%define zz_trace
%ifdef zz_trace
	extern	zz_xl
	extern	zz_xr
	extern	zz_xs
	extern	zz_wa
	extern	zz_wb
	extern	zz_wc
	extern	zz_w0
	extern	zz_zz
	extern	zz_0
	extern	zz_1
	extern	zz_2
	extern	zz_3
	extern	zz_arg
	extern	zz_num
%endif
	global	start

;   table to recover type word from type ordinal

	extern	_rc_
	section .data

	global	mincp
mincp:	dq	0	; Minimal code pointer (CP), maintained in memory for x64

	global	typet

        dq b_art   ; arblk type word - 0
        dq b_cdc   ; cdblk type word - 1
        dq b_exl   ; exblk type word - 2
        dq b_icl   ; icblk type word - 3
        dq b_nml   ; nmblk type word - 4
        dq p_aba   ; p0blk type word - 5
        dq p_alt   ; p1blk type word - 6
        dq p_any   ; p2blk type word - 7
; next needed only if support real arithmetic cnra
;        dq b_rcl   ; rcblk type word - 8
	dq	0   ; temporary replacement for b_rcl (used in real arithmetic)
        dq b_scl   ; scblk type word - 9
        dq b_sel   ; seblk type word - 10
        dq b_tbt   ; tbblk type word - 11
        dq b_vct   ; vcblk type word - 12
        dq b_xnt   ; xnblk type word - 13
        dq b_xrt   ; xrblk type word - 14
        dq b_bct   ; bcblk type word - 15
        dq b_pdt   ; pdblk type word - 16
        dq b_trt   ; trblk type word - 17
        dq b_bft   ; bfblk type word   18
        dq b_cct   ; ccblk type word - 19
        dq b_cmt   ; cmblk type word - 20
        dq b_ctt   ; ctblk type word - 21
        dq b_dfc   ; dfblk type word - 22
        dq b_efc   ; efblk type word - 23
        dq b_evt   ; evblk type word - 24
        dq b_ffc   ; ffblk type word - 25
        dq b_kvt   ; kvblk type word - 26
        dq b_pfc   ; pfblk type word - 27
        dq b_tet   ; teblk type word - 28
;
;   table of minimal entry points that can be dded from c
;   via the minimal function (see inter.asm).
;
;   note that the order of entries in this table must correspond
;   to the order of entries in the call enumeration in osint.h
;   and osint.inc.
;
	global calltab
calltab:
        dq   relaj
        dq   relcr
        dq   reloc
        dq   alloc
        dq   alocs
        dq   alost
        dq   blkln
        dq   insta
        dq   rstrt
        dq   start
        dq   filnm
        dq   dtype
;       dq   enevs ;  engine words
;       dq   engts ;   not used

	global	gbcnt
	global	headv
	global	mxlen
	global	stage
	global	timsx
	global	dnamb
	global	dnamp
	global	state
	global	b_efc
	global	b_icl
	global	b_scl
	global	b_vct
	global	b_xnt
	global	b_xrt
	global	stbas
	global	statb
	global	polct
	global  typet
	global	lowspmin
	global	flprt
	global	flptr
	global	gtcef
	global	hshtb
	global	pmhbs
	global	r_fcb
	global	c_aaa
	global	c_yyy
	global	g_aaa
	global	w_yyy
	global	s_aaa
	global	s_yyy
	global	r_cod
	global	kvstn
	global	kvdmp
	global	kvftr
	global	kvcom
	global	kvpfl
	global	cswfl
        global  stmcs
        global  stmct
	global	b_rcl
	global	end_min_data

        extern ldr_
        extern str_
        extern ovr_
        extern dvi_
        extern rmi_
        extern cvd_
        extern rti_
        extern itr_
        extern adr_
        extern sbr_
        extern mlr_
        extern dvr_
        extern ngr_
        extern atn_
        extern chp_
        extern cos_
        extern etx_
        extern lnf_
        extern sin_
        extern sqr_
        extern tan_
        extern cpr_
